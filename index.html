<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>truedhrec</title>
  </head>
  <script>
  var commanders, baseURL = "https://edhrec-json.s3.amazonaws.com/en/commanders/"
  var allData = []
  var combos = [

    "w",
    "u",
    "b",
    "r",
    "g",
    "colorless",

    "wu",
    "wb",
    "rw",
    "gw",
    "ub",
    "ur",
    "gu",
    "br",
    "bg",
    "rg",

    "wub", //esper
    "urw", //jeskai
    "gwu", //bant
    "rwb", //mardu
    "wbg", //abzan
    "rgw", //naya
    "ubr", //grixis
    "gur", //temur
    "bgu", //sultai
    "brg", //jund

    "brgw",
    "rgwu",
    "gwub",
    "wubr",
    "ubrg",

    "wubrg"

  ]

  var count = 0
  function init () {
    // fetch("https://edhrec-json.s3.amazonaws.com/en/commanders/u.json").then(res => res.json()).then(handleData)

    recursiveFetch()
  }


  function recursiveFetch(data = false) { //COUNT MUST BE 0 BEFORE CALLING THIS
    if (data !== false) {
      allData.push( {"name": combos[count], "data": data} )
    }

    //

  fetch("https://cors-anywhere.herokuapp.com/" + baseURL +  combos[count] + '.json', {
  "headers": {
    "origin": window.location.href
  }
}).then(res => res.json()).then(updateData)

  }

  function handleRecursiveFetch() {
    recursiveFetch(tempData)
  }


  function updateData (data) {
    console.log(data)
    tempData = data
    console.log(tempData)
    count++
    if (count < combos.length) {
      setTimeout(handleRecursiveFetch, 500)
    }


  }

  function handleData(data) {
    console.log(data)
    commanders = data
    displayData(commanders)
  }


  function displayData(data) {
    console.log(data.container.json_dict.cardlists)
  }

  document.addEventListener("DOMContentLoaded", init)

  </script>
  <body>

  </body>
</html>
